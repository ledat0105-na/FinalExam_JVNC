<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thông báo của bạn | UCOP</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <style>
        .notification-card {
            transition: all 0.2s;
            border-left: 4px solid transparent;
        }

        .notification-card.unread {
            background-color: #f8fbff;
            border-left-color: #0d6efd;
        }

        .notification-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .notification-icon {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
    </style>
</head>

<body class="bg-light">

    <!-- Navbar Fragment -->
    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <div class="container py-5" style="margin-top: 60px;">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 class="fw-bold mb-0">
                        <i class="bi bi-bell-fill me-2 text-primary"></i>Thông báo
                    </h2>
                    <form th:action="@{/customer/notifications/read-all}" method="post"
                        th:if="${!notifications.isEmpty()}">
                        <button type="submit" class="btn btn-outline-primary btn-sm rounded-pill">
                            <i class="bi bi-check2-all me-1"></i>Đánh dấu tất cả đã đọc
                        </button>
                    </form>
                </div>

                <div th:if="${notifications.isEmpty()}" class="text-center py-5 text-muted">
                    <i class="bi bi-bell-slash display-4 mb-3 d-block opacity-50"></i>
                    <p class="fs-5">Bạn chưa có thông báo nào</p>
                </div>

                <div class="d-flex flex-column gap-3">
                    <div th:each="notification : ${notifications}" class="card shadow-sm border-0 notification-card"
                        th:classappend="${!notification.isRead} ? 'unread' : ''">
                        <div class="card-body p-3">
                            <div class="d-flex gap-3">
                                <!-- Icon based on type -->
                                <div class="flex-shrink-0">
                                    <div class="notification-icon" th:classappend="${notification.type.name() == 'SUCCESS' ? 'bg-success bg-opacity-10 text-success' : 
                                                         (notification.type.name() == 'WARNING' ? 'bg-warning bg-opacity-10 text-warning' : 
                                                         (notification.type.name() == 'ERROR' ? 'bg-danger bg-opacity-10 text-danger' : 
                                                         'bg-primary bg-opacity-10 text-primary'))}">
                                        <i class="bi fs-4" th:classappend="${notification.type.name() == 'SUCCESS' ? 'bi-check-lg' : 
                                                           (notification.type.name() == 'WARNING' ? 'bi-exclamation-lg' : 
                                                           (notification.type.name() == 'ERROR' ? 'bi-x-lg' : 
                                                           'bi-info-lg'))}"></i>
                                    </div>
                                </div>

                                <div class="flex-grow-1">
                                    <div class="d-flex justify-content-between align-items-start mb-1">
                                        <h5 class="card-title mb-0 fw-bold fs-6" th:text="${notification.title}">Tiêu đề
                                        </h5>
                                        <small class="text-muted ms-2"
                                            th:text="${#temporals.format(notification.createdAt, 'dd/MM/yyyy HH:mm')}">Thời
                                            gian</small>
                                    </div>
                                    <p class="card-text text-secondary small mb-2" th:text="${notification.message}">Nội
                                        dung thông báo</p>

                                    <div class="d-flex gap-2 mt-2">
                                        <a th:if="${notification.link != null}"
                                            th:href="@{'/customer/notifications/' + ${notification.notificationId} + '/go'}"
                                            class="btn btn-sm btn-link p-0 text-decoration-none fw-medium">
                                            Xem chi tiết <i class="bi bi-chevron-right small"></i>
                                        </a>

                                        <form th:if="${!notification.isRead}"
                                            th:action="@{'/customer/notifications/' + ${notification.notificationId} + '/read'}"
                                            method="post" class="ms-auto">
                                            <button type="submit"
                                                class="btn btn-link btn-sm p-0 text-muted text-decoration-none"
                                                title="Đánh dấu đã đọc">
                                                <i class="bi bi-circle small me-1"></i>Đã đọc
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>